{"job":{"components":{"4583":{"id":4583,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-629958239,"x":1280,"y":400,"width":32,"height":32,"inputConnectorIDs":[4595,4597],"outputConnectorIDs":[4598],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Join group_error_flag"}}}},"visible":true},"2":{"slot":2,"name":"Main Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Agg max_error_flag"}}}},"visible":true},"3":{"slot":3,"name":"Main Table Alias","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"agg"}}}},"visible":true},"4":{"slot":4,"name":"Joins","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calc error_flag"},"2":{"slot":2,"type":"STRING","value":"main"},"3":{"slot":3,"type":"STRING","value":"Inner"}}}},"visible":true},"5":{"slot":5,"name":"Join Expressions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"\"agg\".\"id1\" = \"main\".\"id1\" AND \"agg\".\"id2\" = \"main\".\"id2\""},"2":{"slot":2,"type":"STRING","value":"agg_Inner_main"}}}},"visible":true},"6":{"slot":6,"name":"Output Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"main.id1"},"2":{"slot":2,"type":"STRING","value":"id1"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"main.id2"},"2":{"slot":2,"type":"STRING","value":"id2"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"main.gueltigvon"},"2":{"slot":2,"type":"STRING","value":"gueltigvon"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"main.gueltigbis"},"2":{"slot":2,"type":"STRING","value":"gueltigbis"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"main.contents"},"2":{"slot":2,"type":"STRING","value":"contents"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"agg.max_flag_error"},"2":{"slot":2,"type":"STRING","value":"max_flag_error"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4584":{"id":4584,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1701703136,"x":1168,"y":320,"width":32,"height":32,"inputConnectorIDs":[4596],"outputConnectorIDs":[4597],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Agg max_error_flag"}}}},"visible":true},"2":{"slot":2,"name":"Groupings","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id1"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"id2"}}}},"visible":true},"3":{"slot":3,"name":"Aggregations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"flag_error"},"2":{"slot":2,"type":"STRING","value":"Max"}}}},"visible":true},"4":{"slot":4,"name":"Grouping Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Group By"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4585":{"id":4585,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":1440,"y":400,"width":32,"height":32,"inputConnectorIDs":[4598],"outputConnectorIDs":[4590],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter errors"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"max_flag_error"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4586":{"id":4586,"inputCardinality":"ZERO_OR_MANY","outputCardinality":"MANY","implementationID":-1266674941,"x":272,"y":480,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[4599],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SQL manual_select_query"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${j_select_query}"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4587":{"id":4587,"inputCardinality":"MANY","outputCardinality":"MANY","implementationID":-1841822228,"x":400,"y":400,"width":32,"height":32,"inputConnectorIDs":[4599,4600],"outputConnectorIDs":[4591],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Unite"}}}},"visible":true},"2":{"slot":2,"name":"Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"All Columns"}}}},"visible":true},"3":{"slot":3,"name":"Cast Types","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"4":{"slot":4,"name":"Add Source Component Column","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"5":{"slot":5,"name":"Remove duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4588":{"id":4588,"inputCardinality":"ZERO","outputCardinality":"MANY","implementationID":1354890871,"x":272,"y":320,"width":32,"height":32,"inputConnectorIDs":[],"outputConnectorIDs":[4600],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"t_source_table"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"t_source_table"}}}},"visible":true},"3":{"slot":3,"name":"Column Names","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id1"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"id2"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"contents"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"gueltigvon"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"gueltigbis"}}}},"visible":true},"5":{"slot":5,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"7":{"slot":7,"name":"Offset","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4589":{"id":4589,"inputCardinality":"ONE","outputCardinality":"ZERO","implementationID":211954775,"x":1600,"y":400,"width":32,"height":32,"inputConnectorIDs":[4590],"outputConnectorIDs":[],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"t_staging_table"}}}},"visible":true},"2":{"slot":2,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"t_staging_table"}}}},"visible":true},"4":{"slot":4,"name":"Column Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id1"},"2":{"slot":2,"type":"STRING","value":"id1"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"id2"},"2":{"slot":2,"type":"STRING","value":"id2"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"contents"},"2":{"slot":2,"type":"STRING","value":"contents"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"gueltigvon"},"2":{"slot":2,"type":"STRING","value":"gueltigvon"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"gueltigbis"},"2":{"slot":2,"type":"STRING","value":"gueltigbis"}}}},"visible":true},"5":{"slot":5,"name":"Truncate","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate"}}}},"visible":true},"200":{"slot":200,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"201":{"slot":201,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"202":{"slot":202,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"203":{"slot":203,"name":"Fix Data Type Mismatches","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true},"204":{"slot":204,"name":"Order By","elements":{},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4629":{"id":4629,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":2139809017,"x":560,"y":400,"width":32,"height":32,"inputConnectorIDs":[4591],"outputConnectorIDs":[4592],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Rank calc row_number"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"g_key_columns"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"columnname"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"g_duplicate_selection_order"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"columnname"},"2":{"slot":2,"type":"GRID","value":"sort_direction"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Row Number"},"2":{"slot":2,"type":"STRING","value":"rnk"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4630":{"id":4630,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1760161015,"x":720,"y":400,"width":32,"height":32,"inputConnectorIDs":[4592],"outputConnectorIDs":[4594],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Filter row_number = 1"}}}},"visible":true},"2":{"slot":2,"name":"Filter Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"rnk"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Equal to"},"4":{"slot":4,"type":"STRING","value":"1"}}}},"visible":true},"3":{"slot":3,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4631":{"id":4631,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":-1593650416,"x":912,"y":400,"width":32,"height":32,"inputConnectorIDs":[4594],"outputConnectorIDs":[4593],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Lag gb"}}}},"visible":true},"2":{"slot":2,"name":"Include input columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Partition Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"id1"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"id2"}}}},"visible":true},"4":{"slot":4,"name":"Ordering within partitions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"gueltigvon"},"2":{"slot":2,"type":"STRING","value":"Asc"}}}},"visible":true},"5":{"slot":5,"name":"Functions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Lag"},"2":{"slot":2,"type":"STRING","value":"gueltigbis"},"3":{"slot":3,"type":"INTEGER","value":"1"},"4":{"slot":4,"type":"STRING","value":"lag_gueltigbis"}}}},"visible":true},"6":{"slot":6,"name":"Ignore Nulls","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"No"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"},"4632":{"id":4632,"inputCardinality":"ONE","outputCardinality":"MANY","implementationID":1716658327,"x":1024,"y":400,"width":32,"height":32,"inputConnectorIDs":[4593],"outputConnectorIDs":[4595,4596],"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Calc error_flag"}}}},"visible":true},"2":{"slot":2,"name":"Include Input Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"3":{"slot":3,"name":"Calculations","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CASE WHEN \"gueltigvon\" < \"lag_gueltigbis\" \nTHEN 1\nELSE 0 --auch den ersten Eintrag mit lag_gb = NULL\nEND\n"},"2":{"slot":2,"type":"STRING","value":"flag_error"}}}},"visible":true}},"exportMappings":{},"expectedFailure":null,"activationStatus":"ENABLED"}},"connectors":{"4590":{"id":4590,"sourceID":4585,"targetID":4589},"4591":{"id":4591,"sourceID":4587,"targetID":4629},"4592":{"id":4592,"sourceID":4629,"targetID":4630},"4593":{"id":4593,"sourceID":4631,"targetID":4632},"4594":{"id":4594,"sourceID":4630,"targetID":4631},"4595":{"id":4595,"sourceID":4632,"targetID":4583},"4596":{"id":4596,"sourceID":4632,"targetID":4584},"4597":{"id":4597,"sourceID":4584,"targetID":4583},"4598":{"id":4598,"sourceID":4583,"targetID":4585},"4599":{"id":4599,"sourceID":4586,"targetID":4587},"4600":{"id":4600,"sourceID":4588,"targetID":4587}},"notes":{"4626":{"id":4626,"x":502,"y":303,"width":274,"height":159,"text":"removes duplicates","colour":"e6e63c"},"4627":{"id":4627,"x":1113,"y":264,"width":225,"height":191,"text":"flags groups with errors, when one record has an error","colour":"e6e63c"},"4628":{"id":4628,"x":830,"y":312,"width":256,"height":151,"text":"detects gv/gb inconsistencies and flags them as errors","colour":"e6e63c"}},"noteConnectors":{},"variables":{"j_select_query":{"definition":{"name":"j_select_query","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PUBLIC"},"value":"SELECT 1 as id1, 1 as id2, '2015-01-01' as gueltigvon, '2016-01-01' as gueltigbis, 'kein content' as content"}},"grids":{"g_duplicate_selection_order":{"definition":{"name":"g_duplicate_selection_order","scope":"BRANCH","definitions":[{"name":"columnname","type":"TEXT"},{"name":"sort_direction","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["gueltigvon","Asc"]}]},"g_key_columns":{"definition":{"name":"g_key_columns","scope":"BRANCH","definitions":[{"name":"columnname","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["id1"]},{"values":["id2"]},{"values":["gueltigvon"]},{"values":["gueltigbis"]}]}}},"info":{"name":"t_load_staging_2","description":"","type":"TRANSFORMATION","tag":"b9e1ffb8-45a1-41ba-97f8-4cd390ed1f3d"}}